import path from'path';import{mkfile,mkdir}from'@hexlet/immutable-fs-trees';import{checkStructure,checkW3C,checkCSS,checkOrderStylesheetLinks,checkAlternativeFonts,checkBodyElements,checkLang,checkTitleEmmet,checkElementsBySelectors,checkPropertiesByElement,checkVideoAttributes,checkPseudoElements,checkHorizontalScroll,checkLayout}from'./lib.js';import initPuppeteer from'./puppeteer.js';const runTests=async(a,b)=>{const c=mkdir('project',[mkfile('index.html'),mkdir('styles',[mkfile('style.css')]),mkdir('fonts',[mkfile('font.css')]),mkdir('video'),mkdir('images')]),d=checkStructure(a,c);if(d.length)return d;const{browser:e,page:f}=await initPuppeteer(path.join(a,'index.html')),g=(await Promise.all([checkW3C(path.join(a,'index.html')),checkCSS(a),checkOrderStylesheetLinks(f,['font.css','style.css']),checkAlternativeFonts(path.join(a,'styles','style.css'),['Raleway']),checkBodyElements(f,['video','h1']),checkLang(f,b),checkTitleEmmet(f),checkElementsBySelectors(f,[{name:'description',selector:'meta[name="description"][content]:not([content=""])'},{name:'og:url',selector:'meta[property="og:url"][content]:not([content=""])'},{name:'og:title',selector:'meta[property="og:title"][content]:not([content=""])'},{name:'og:description',selector:'meta[property="og:description"][content]:not([content=""])'},{name:'og:image',selector:'meta[property="og:image"][content]:not([content=""])'},{name:'twitter:card',selector:'meta[property="twitter:card"][content]:not([content=""])'}],'metaTagsMissing'),checkElementsBySelectors(f,[{name:'ico',selector:'link[rel="icon"][href$=".ico"]'},{name:'svg',selector:'link[rel="icon"][href$=".svg"]'}],'faviconsMissing'),checkElementsBySelectors(f,[{name:'apple-touch-icon',selector:'link[rel="apple-touch-icon"]'}],'mobileFaviconMissing'),checkPropertiesByElement(f,'body',{margin:'0px'}),checkVideoAttributes(f,['muted','autoplay','poster','loop'],['controls']),checkPseudoElements(path.join(a,'styles','style.css')),checkHorizontalScroll(f),checkLayout(f)])).flat();return await e.close(),g};export default runTests;